function [y, T, residual, g1] = dynamic_4(y, x, params, steady_state, sparse_rowval, sparse_colval, sparse_colptr, T)
residual=NaN(20, 1);
  residual(1)=(y(47))-(1.7*y(48)-0.7*y(20)+0.99*y(13)+y(64));
  residual(2)=(y(53))-(params(50)*x(13)+(1-params(50))*y(73));
  T(1)=(1-params(29))*(1-params(6)*params(14)*params(29))/((1+params(6)*params(14))*params(29))*1/(1+(params(8)-1)*params(11));
  T(2)=1/(1+T(1));
  T(3)=y(43)*params(30)+y(41)*1/(1-params(28)/params(6))-y(7)*params(28)/params(6)/(1-params(28)/params(6));
  residual(3)=(y(51))-(T(2)*(1/(1+params(6)*params(14))*y(6)+params(6)*params(14)/(1+params(6)*params(14))*y(74)+params(32)/(1+params(6)*params(14))*y(5)-y(39)*(1+params(6)*params(14)*params(32))/(1+params(6)*params(14))+y(53)*params(6)*params(14)/(1+params(6)*params(14))+T(1)*T(3)+y(61)));
  residual(4)=(y(40))-(y(51)*params(41)+y(52)*(1-params(41)));
  residual(5)=(y(41))-((y(42)-y(36)*params(21)-y(55)-params(23)*1/(params(34)/(1-params(34)))*y(44)-0.01*y(47))/params(22));
  residual(6)=(y(45))-((-params(43))*(y(47)-y(37)-y(38))-params(46)*y(49)+y(63));
  residual(7)=(y(48))-(params(15)/(params(15)+1-params(7))*(y(42)-y(38))+y(37)*(1-params(7))/(params(15)+1-params(7))-y(3));
  residual(8)=(y(49))-(y(15)+params(45)*(y(50)-y(16))+y(65));
  residual(9)=(y(50))-(y(38)*1.17278+y(49)*0.073148-y(47)*0.245928);
  residual(10)=(y(54))-(y(80));
  residual(11)=(y(38))-((1-params(17))*y(4)+y(36)*params(17)+y(57)*params(26)*params(6)*params(6)*params(17));
  residual(12)=(y(39))-((y(35)-params(37)*y(1)-params(38)*(1-params(37))*y(42)-params(39)*(y(42)-y(8))-y(58))/((1-params(37))*params(36)));
  residual(13)=(y(43))-(y(4)+1/(params(34)/(1-params(34)))*y(44)+y(44)-y(40));
  T(4)=1/((1-params(28)/params(6))/(params(27)*(1+params(28)/params(6))));
  residual(14)=(y(35))-(y(53)+T(4)*(params(28)/params(6)/(1+params(28)/params(6))*y(7)+1/(1+params(28)/params(6))*y(75)+(params(27)-1)*params(24)/(params(27)*(1+params(28)/params(6)))*(y(43)-y(77))+y(56)-y(41)));
  residual(15)=(y(36))-(1/(1+params(6)*params(14))*(y(2)+params(6)*params(14)*y(70)+1/(params(6)*params(6)*params(26))*y(37))+y(57));
  residual(16)=(y(37))-(params(15)/(params(15)+1-params(7))*y(78)-y(80)+(1-params(7))/(params(15)+1-params(7))*y(71));
  residual(17)=(y(52))-(T(3)-(y(39)-y(53))+y(62));
  residual(18)=(y(42))-(params(35)*(params(40)*(y(4)+1/(params(34)/(1-params(34)))*y(44))+y(43)*(1-params(40))+y(59)));
  T(5)=(1-params(31))*(1-params(6)*params(14)*params(31))/params(31)/(1+(params(35)-1)*params(10));
  residual(19)=(y(44))-(params(42)*(y(59)+((y(39)-y(60))*(1+params(6)*params(14)*params(33))-(y(53)*params(6)*params(14)+y(5)*params(33)))/T(5)-y(40)*(1-params(40)))/params(40)+(1-params(42))*((1-params(40))/params(40)*(-y(40))+y(59)/params(40)));
  residual(20)=(y(46))-(y(11)+y(1)-y(53));
if nargout > 3
    g1_v = NaN(89, 1);
g1_v(1)=(-0.99);
g1_v(2)=(-1);
g1_v(3)=(-(params(39)/((1-params(37))*params(36))));
g1_v(4)=params(45);
g1_v(5)=(-1);
g1_v(6)=0.7;
g1_v(7)=(-(1-params(17)));
g1_v(8)=(-1);
g1_v(9)=(-(params(35)*params(40)));
g1_v(10)=(-((-params(37))/((1-params(37))*params(36))));
g1_v(11)=(-1);
g1_v(12)=(-(1/(1+params(6)*params(14))*T(2)));
g1_v(13)=(-(T(2)*T(1)*(-(params(28)/params(6)/(1-params(28)/params(6))))));
g1_v(14)=(-(T(4)*params(28)/params(6)/(1+params(28)/params(6))));
g1_v(15)=params(28)/params(6)/(1-params(28)/params(6));
g1_v(16)=(-(1/(1+params(6)*params(14))));
g1_v(17)=1;
g1_v(18)=(-(T(2)*params(32)/(1+params(6)*params(14))));
g1_v(19)=(-(params(42)*(-params(33))/T(5)/params(40)));
g1_v(20)=(-1.7);
g1_v(21)=1;
g1_v(22)=1;
g1_v(23)=(-(T(2)*params(6)*params(14)/(1+params(6)*params(14))));
g1_v(24)=(-1);
g1_v(25)=(-1);
g1_v(26)=(-(params(42)*(-(params(6)*params(14)))/T(5)/params(40)));
g1_v(27)=1;
g1_v(28)=1;
g1_v(29)=(-params(41));
g1_v(30)=(-(1-params(41)));
g1_v(31)=1;
g1_v(32)=1;
g1_v(33)=(-((-0.01)/params(22)));
g1_v(34)=params(43);
g1_v(35)=0.245928;
g1_v(36)=1;
g1_v(37)=(-(1/params(22)));
g1_v(38)=(-(params(15)/(params(15)+1-params(7))));
g1_v(39)=(-(((-(params(38)*(1-params(37))))-params(39))/((1-params(37))*params(36))));
g1_v(40)=1;
g1_v(41)=(-params(45));
g1_v(42)=1;
g1_v(43)=params(46);
g1_v(44)=1;
g1_v(45)=(-0.073148);
g1_v(46)=1;
g1_v(47)=(-params(43));
g1_v(48)=params(15)/(params(15)+1-params(7));
g1_v(49)=(-1.17278);
g1_v(50)=1;
g1_v(51)=(-(1/((1-params(37))*params(36))));
g1_v(52)=1;
g1_v(53)=1;
g1_v(54)=1;
g1_v(55)=(-(params(42)*(-(1-params(40)))/params(40)+(1-params(42))*(-((1-params(40))/params(40)))));
g1_v(56)=(-(T(2)*T(1)*1/(1-params(28)/params(6))));
g1_v(57)=1;
g1_v(58)=T(4);
g1_v(59)=(-(1/(1-params(28)/params(6))));
g1_v(60)=(-((-params(21))/params(22)));
g1_v(61)=(-params(17));
g1_v(62)=1;
g1_v(63)=(-params(43));
g1_v(64)=(-((1-params(7))/(params(15)+1-params(7))));
g1_v(65)=(-(1/(1+params(6)*params(14))*1/(params(6)*params(6)*params(26))));
g1_v(66)=1;
g1_v(67)=(-(T(2)*(-((1+params(6)*params(14)*params(32))/(1+params(6)*params(14))))));
g1_v(68)=1;
g1_v(69)=1;
g1_v(70)=(-(params(42)*(1+params(6)*params(14)*params(33))/T(5)/params(40)));
g1_v(71)=(-(T(2)*T(1)*params(30)));
g1_v(72)=1;
g1_v(73)=(-(T(4)*(params(27)-1)*params(24)/(params(27)*(1+params(28)/params(6)))));
g1_v(74)=(-params(30));
g1_v(75)=(-(params(35)*(1-params(40))));
g1_v(76)=(-((-(params(23)*1/(params(34)/(1-params(34)))))/params(22)));
g1_v(77)=(-(1+1/(params(34)/(1-params(34)))));
g1_v(78)=(-(params(35)*1/(params(34)/(1-params(34)))*params(40)));
g1_v(79)=1;
g1_v(80)=1;
g1_v(81)=(-(T(2)*params(6)*params(14)/(1+params(6)*params(14))));
g1_v(82)=(-(T(4)*1/(1+params(28)/params(6))));
g1_v(83)=(-(params(6)*params(14)*1/(1+params(6)*params(14))));
g1_v(84)=(-((1-params(7))/(params(15)+1-params(7))));
g1_v(85)=(-(1-params(50)));
g1_v(86)=(-(T(4)*(-((params(27)-1)*params(24)/(params(27)*(1+params(28)/params(6)))))));
g1_v(87)=(-(params(15)/(params(15)+1-params(7))));
g1_v(88)=(-1);
g1_v(89)=1;
    if ~isoctave && matlab_ver_less_than('9.8')
        sparse_rowval = double(sparse_rowval);
        sparse_colval = double(sparse_colval);
    end
    g1 = sparse(sparse_rowval, sparse_colval, g1_v, 20, 60);
end
end
